import React, { useContext, useState } from 'react'
import { Container } from '@material-ui/core'
import { ContagionDynamics, VulnerabilityDistributions } from '../../../components/VulnerabilityGroup'
import CompartmentalButton from '../../../components/CompartmentalModels/CompartmentalButton'
import DiseaseState from '../../../pages/AgentsBasedModelPage/DiseaseState'
import { vulnerabilityGroupState } from './state'
import { vulnerabilityStyles } from './styles'
import { OPTIONS_MODAL } from '../../../constants/agents'
import { renderComponentChildre } from '../../../utils/common'
import { AgentsModalContainer } from '../../../components/AgentsModels/AgentsModalContainer'
import AgentsBaseContext from '../../../context/agentsBase.context'

const VulnerabilityGroup = () => {
  const classes = vulnerabilityStyles()
  const context = useContext(AgentsBaseContext)
  const { distributionList, parameterList } = context
  const [modalSettings,setModalSettings] = useState({
    open:false,
    item:{},
    index:0
  })

  const [
    tableParameters,
    initialItemsDistribution,
    tableTransitionsParameters,
    handleSwitchChange,
    json,
    modal,
    closeModal
  ] = vulnerabilityGroupState()

  const [componentChildren, setComponentChildren] = useState(OPTIONS_MODAL.DISTRIBUTION)
  const Component = renderComponentChildre(componentChildren, {
    distributionList, parameterList, modalSettings
  })

  return (
    <>
      <div className={classes.generalContainer}>
        <Container>
          <Container maxWidth='xl'>
            <div className={classes.containerScreenFirstPart}>
              <ContagionDynamics
                classes={classes}
                json={json}
                handleSwitchChange={handleSwitchChange}
              />
              <hr />
              { json.ContagionDynamics &&
                <>
                  <div className={classes.containerDistributionsSettings}>
                    <h3 className={classes.TitleColorFont}><strong>Distributions</strong></h3>
                    <VulnerabilityDistributions
                      classes={classes}
                      description='Time distribution'
                      handleFunctionOne={''}
                      handleFunctionTwo={''}
                      handleFunctionThree={''}
                    />
                    <VulnerabilityDistributions
                      classes={classes}
                      description='Alertness'
                      handleFunctionOne={''}
                      handleFunctionTwo={''}
                      handleFunctionThree={''}
                    />
                  </div>
                  <hr />
                </>
              }
              <div className={classes.ctnDiseaseState}>
                <DiseaseState data={tableParameters} onchange={()=>{}}/>
              </div>
              <hr />
            </div>
          </Container>
          <h3 className={classes.TitleColorFont}><strong>Transitions</strong></h3>
          <div className={classes.ctnDiseaseStateSecond}>
            <DiseaseState data={tableTransitionsParameters} onchange={()=>{}}/>
          </div>
          <div className={classes.ctnDiseaseStateSecond}>
            <CompartmentalButton
              justify='flex-end'
              alignItems='center'
              text='Done'
              onClick={''}
              disabled={false}
            /> 
          </div>
        </Container>
      </div>
      {/* <AgentsModalContainer
        modalTitle='<TYPE>'       
        open={modal}
        handleClose={closeModal}           
        render={Component}
      /> */}
    </>
  )
}

export default VulnerabilityGroup
